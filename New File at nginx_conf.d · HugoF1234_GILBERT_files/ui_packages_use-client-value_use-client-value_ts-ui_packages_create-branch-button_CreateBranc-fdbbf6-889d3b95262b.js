"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_use-client-value_use-client-value_ts-ui_packages_create-branch-button_CreateBranc-fdbbf6"],{69719:(e,t,r)=>{let n;r.d(t,{H:()=>F});var a=r(10204);function o(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function i(e,t,r){if(!t.has(e))throw TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}var s=new WeakMap,l=new WeakSet;let AliveSession=class AliveSession extends a.ib{constructor(e,t,r,n,a){super(e,()=>(function(e,t,r){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return r})(this,l,c).call(this),r,n,void 0,a),function(e,t){o(e,t),t.add(e)}(this,l),function(e,t,r){o(e,t),t.set(e,r)}(this,s,{writable:!0,value:void 0}),function(e,t,r){var n=i(e,t,"set");if(n.set)n.set.call(e,r);else{if(!n.writable)throw TypeError("attempted to set read only private field");n.value=r}}(this,s,t)}};function c(){var e;return u((e=i(this,s,"get"),e.get?e.get.call(this):e.value))}async function u(e){let t=await d(e);return t&&t.url&&t.token?h(t.url,t.token):null}async function d(e){let t=await fetch(e,{headers:{Accept:"application/json"}});if(t.ok)return t.json();if(404===t.status)return null;throw Error("fetch error")}async function h(e,t){let r=await fetch(e,{method:"POST",mode:"same-origin",headers:{"Scoped-CSRF-Token":t}});if(r.ok)return r.text();throw Error("fetch error")}var p=r(70170),m=r(32475),f=r(85351),b=r(23683),v=r(27851);function w(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function y(e,t,r){if(!t.has(e))throw TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function g(e,t){var r=y(e,t,"get");return r.get?r.get.call(e):r.value}function x(e,t,r){w(e,t),t.set(e,r)}function N(e,t,r){var n=y(e,t,"set");if(n.set)n.set.call(e,r);else{if(!n.writable)throw TypeError("attempted to set read only private field");n.value=r}return r}function C(e,{channel:t,type:r,data:n}){for(let a of e)a.dispatchEvent(new CustomEvent(`socket:${r}`,{bubbles:!1,cancelable:!1,detail:{name:t,data:n}}))}var k=new WeakMap,j=new WeakMap,T=new WeakMap,S=new WeakMap,_=new WeakMap,E=new WeakSet;let P=class AliveSessionProxy{subscribe(e){let t=g(this,j).add(...e);t.length&&g(this,k).port.postMessage({subscribe:t});let r=new Set(t.map(e=>e.name)),n=e.reduce((e,t)=>{let n=t.topic.name;return(0,a.JR)(n)&&!r.has(n)&&e.add(n),e},new Set);n.size&&g(this,k).port.postMessage({requestPresence:Array.from(n)})}unsubscribeAll(...e){let t=g(this,j).drain(...e);t.length&&g(this,k).port.postMessage({unsubscribe:t});let r=g(this,T).removeSubscribers(e);this.sendPresenceMetadataUpdate(r)}updatePresenceMetadata(e){let t=new Set;for(let r of e)g(this,T).setMetadata(r),t.add(r.channelName);this.sendPresenceMetadataUpdate(t)}sendPresenceMetadataUpdate(e){if(!e.size)return;let t=[];for(let r of e)t.push({channelName:r,metadata:g(this,T).getChannelMetadata(r)});g(this,k).port.postMessage({updatePresenceMetadata:t})}online(){g(this,k).port.postMessage({online:!0})}offline(){g(this,k).port.postMessage({online:!1})}hangup(){g(this,k).port.postMessage({hangup:!0})}constructor(e,t,r,n,o,i){!function(e,t){w(e,t),t.add(e)}(this,E),x(this,k,{writable:!0,value:void 0}),x(this,j,{writable:!0,value:new a.m0}),x(this,T,{writable:!0,value:new a.VH}),x(this,S,{writable:!0,value:void 0}),x(this,_,{writable:!0,value:new Map}),N(this,S,o),N(this,k,new SharedWorker(`${e}?module=true`,{name:`github-socket-worker-v3-${n}`,type:"module"})),g(this,k).port.onmessage=({data:e})=>(function(e,t,r){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return r})(this,E,A).call(this,e),g(this,k).port.postMessage({connect:{url:t,refreshUrl:r,options:i}})}};function A(e){let{channel:t}=e;if("presence"===e.type){let r=g(this,_).get(t);r||(r=(0,p.s)((e,r)=>{g(this,S).call(this,e,r),g(this,_).delete(t)},100),g(this,_).set(t,r)),r(g(this,j).subscribers(t),e);return}g(this,S).call(this,g(this,j).subscribers(t),e)}async function B(){let e=function(){let e=document.head.querySelector("link[rel=shared-web-socket-src]")?.getAttribute("href");return e&&e.startsWith("/")?e:null}();if(!e)return;let t=document.head.querySelector("link[rel=shared-web-socket]")?.href??null;if(!t)return;let r=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-refresh-url")??null;if(!r)return;let n=document.head.querySelector("link[rel=shared-web-socket]")?.getAttribute("data-session-id")??null;if(!n)return;let a=(()=>{let a=(0,v.G7)("alive_legacy_retries")?{socketPolicy:{timeout:4e3,attempts:7}}:{};if(!(0,b.nr)()&&"SharedWorker"in window&&"true"!==(0,f.A)("localStorage").getItem("bypassSharedWorker"))try{return new P(e,t,r,n,C,a)}catch{}return new AliveSession(t,r,!1,C,a)})();return window.addEventListener("online",()=>a.online()),window.addEventListener("offline",()=>a.offline()),window.addEventListener("pagehide",()=>{"hangup"in a&&a.hangup()}),a}async function M(){return await m.G,B()}function F(){return n||(n=M())}},35932:(e,t,r)=>{r.d(t,{$:()=>i});var n=r(10204),a=r(76899);let o=new WeakMap;function i(e,t,r){let i;if(!e)throw Error("Not connected to alive");if(!t)throw Error("No channel name");let s=n.KK.parse(t);if(!s)throw Error("Invalid channel name");let l={subscriber:{dispatchEvent:e=>{e instanceof CustomEvent&&r(e.detail.data)}},topic:s},c=((i=o.get(e))||(i={subscribe:(0,a.rK)(t=>e.subscribe(t.flat())),unsubscribeAll:(0,a.rK)(t=>e.unsubscribeAll(...t))},o.set(e,i)),i);return c.subscribe([l]),{unsubscribe:()=>c.unsubscribeAll(l.subscriber)}}},640:(e,t,r)=>{r.d(t,{D:()=>n});function n(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e);let t=document.body;if(!t)return Promise.reject(Error());let r=function(e){let t=document.createElement("pre");return t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.top="5px",t.textContent=e,t}(e);return t.appendChild(r),!function(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e.textContent||"");let t=getSelection();if(null==t)return Promise.reject(Error());t.removeAllRanges();let r=document.createRange();r.selectNodeContents(e),t.addRange(r),document.execCommand("copy"),t.removeAllRanges(),Promise.resolve()}(r),t.removeChild(r),Promise.resolve()}},76899:(e,t,r)=>{function n(){return Promise.resolve()}function a(){return new Promise(window.requestAnimationFrame)}async function o(e,t){let r,n=new Promise(t=>{r=self.setTimeout(t,e)});if(!t)return n;try{await Promise.race([n,function(e){return new Promise((t,r)=>{let n=Error("aborted");n.name="AbortError",e.aborted?r(n):e.addEventListener("abort",()=>r(n))})}(t)])}catch(e){throw self.clearTimeout(r),e}}r.d(t,{G$:()=>a,k2:()=>n,rK:()=>i,uk:()=>o});function i(e){let t=[];return function(r){t.push(r),1===t.length&&queueMicrotask(()=>{let r=t.slice(0);t.length=0,e(r)})}}},98013:(e,t,r)=>{r.d(t,{x:()=>p});var n,a=r(96540),o=r(64899),i=r(69719),s=r(35932),l=r(74848),c=r(10204);let u=(0,a.createContext)(null),d=null;function h(e,t){let r=c.KK.parse(e);if(!r)throw Error(`Invalid channel name. Did you forget to sign it with \`signChannel("${e}")\`?`);return d||(d=new c.m0),d.add({topic:r,subscriber:t}),{unsubscribe:()=>{d?.delete({topic:r,subscriber:t})}}}try{u.displayName||(u.displayName="AliveTestContext")}catch{}try{(n=function({children:e,initialMessages:t}){return(0,a.useEffect)(()=>{let e=[];if(t)for(let[r,n]of t){let t=window.setTimeout(()=>{var e=r,t=n;if(null===d)throw Error('Test helper `dispatchAliveTestMessage` called outside `AliveTestProvider`. Please wrap your component under test in `AliveTestProvider` from "@github-ui/use-alive/test-utils".');for(let r of Array.from(d.subscribers(e)))r(t)},0);e.push(t)}return()=>{for(let t of(d=null,e))window.clearTimeout(t)}}),(0,l.jsx)(u.Provider,{value:h,children:e})}).displayName||(n.displayName="AliveTestProvider")}catch{}function p(e,t){let r=(0,o.A)(),n=(0,a.useContext)(u);(0,a.useEffect)(()=>{let a=()=>{},o=!1;return async function(){if(e){if("function"==typeof n){let r=await n(e,t);r&&(a=r.unsubscribe);return}try{let n=await (0,i.H)();if(o)return;let l=(0,s.$)(n,e,t);l?.unsubscribe&&(r()?a=l.unsubscribe:l.unsubscribe())}catch(e){console.error(e)}}}(),()=>{o=!0,a()}},[e,t,r,n])}},80663:(e,t,r)=>{r.d(t,{I:()=>i});var n=r(96540),a=r(17515),o=r(60674);function i(e,t,r=[]){let s=(0,n.useCallback)(e,r),l=(0,o.BP)(),c=(0,n.useRef)(l===o.O8.ClientRender),[u,d]=(0,n.useState)(()=>l===o.O8.ClientRender?s():t),h=(0,n.useCallback)(()=>{d(s)},[s]);return(0,a.N)(()=>{c.current||d(s),c.current=!1},[s,...r]),[u,h]}},8579:(e,t,r)=>{r.d(t,{T:()=>p});var n=r(74848),a=r(64899),o=r(38621),i=r(87330),s=r(96540),l=r(34164),c=r(18828),u=r(52811),d=r(640);let h={tooltip:"CopyToClipboardButton-module__tooltip--Dq1IB"};function p({icon:e=o.CopyIcon,size:t="medium",onCopy:r,textToCopy:p,tooltipProps:m,variant:f="invisible",ariaLabel:b,className:v,disabled:w,...y}){let[g,x]=s.useState(!1),N=(0,a.A)(),C=b??`Copy "${p}" to clipboard`,k=g?"Copied!":C,j={size:t,variant:f,onClick:()=>{x(!0),(0,u.i)("Copied!"),(0,d.D)(p),r?.(),setTimeout(()=>N()&&x(!1),2e3)},icon:g?o.CheckIcon:e,className:(0,l.$)(g?"color-fg-success":void 0,v),...y},T=(0,s.useId)();return w?(0,n.jsx)(i.K,{...j,"aria-label":C,disabled:!0}):(0,n.jsx)(c.m,{text:k,"aria-label":C,type:"label",id:T,"aria-hidden":!0,...m,className:(0,l.$)(h.tooltip,m?.className),children:(0,n.jsx)(i.K,{...j,"aria-labelledby":T})})}try{p.displayName||(p.displayName="CopyToClipboardButton")}catch{}},56755:(e,t,r)=>{r.d(t,{F:()=>j});var n=r(74848),a=r(96540),o=r(55847),i=r(73451),s=r(9852),l=r(50609),c=r(60039),u=r(71678),d=r(8579),h=r(9591);let p={NewBranchNameInputGroup:"NewBranchName-module__NewBranchNameInputGroup--Ljsp4",TextInput:"NewBranchName-module__TextInput--jWBUY",copyButtonContainer:"NewBranchName-module__copyButtonContainer--DZ69E",CopyToClipboardButton:"NewBranchName-module__CopyToClipboardButton--lKY1s"};var m=r(34164);let f=(0,a.forwardRef)(function({newBranchName:e,setNewBranchName:t},r){return(0,n.jsxs)(i.A,{children:[(0,n.jsx)(i.A.Label,{children:"New branch name"}),(0,n.jsxs)("div",{className:p.NewBranchNameInputGroup,children:[(0,n.jsx)(h.A,{block:!0,className:(0,m.$)("color-bg-subtle",p.TextInput),value:e,onChange:e=>t(e.target.value),ref:r}),(0,n.jsx)("div",{className:(0,m.$)("color-bg-subtle",p.copyButtonContainer),children:(0,n.jsx)(d.T,{tooltipProps:{direction:"nw"},textToCopy:e,ariaLabel:"Copy to clipboard",className:(0,m.$)("pt-1",p.CopyToClipboardButton)})})]})]})});try{f.displayName||(f.displayName="NewBranchName")}catch{}var b=r(3971),v=r(15385),w=r(38621);let y={ForkPickerButtonContent:"ForkPicker-module__ForkPickerButtonContent--htsjB",repoIconContainer:"ForkPicker-module__repoIconContainer--of046",repoNameContainer:"ForkPicker-module__repoNameContainer--xVv8f",repoNameText:"ForkPicker-module__repoNameText--QtXR6"};function g(e){return`${e.ownerLogin}/${e.name}`}function x({isForkSourceOpen:e,setForkSourceOpen:t,repoSource:r,setRepoSource:i,repository:s,repositoryParent:l,setDefaultBranch:c,setBranchSource:u}){return(0,n.jsxs)(a.Fragment,{children:[(0,n.jsx)("span",{className:"note text-small mt-0",children:"Choose from this fork or its upstream repository."}),(0,n.jsx)(b.T,{open:e,overlayProps:{role:"dialog",width:"medium"},onOpen:()=>t(!0),onClose:()=>t(!1),renderAnchor:e=>(0,n.jsx)(o.Q,{...e,trailingVisual:w.TriangleDownIcon,"aria-label":g(r),"data-testid":"anchor-button",children:(0,n.jsxs)("div",{className:y.ForkPickerButtonContent,children:[(0,n.jsx)("div",{className:y.repoIconContainer,children:(0,n.jsx)(w.RepoIcon,{size:"small"})}),(0,n.jsx)("div",{className:y.repoNameContainer,children:(0,n.jsxs)("span",{className:y.repoNameText,children:["\xa0",`${g(r)}`]})})]})}),focusZoneSettings:{disabled:!0},children:(0,n.jsx)("div",{"data-testid":"overlay-content",id:"selectPanel",children:(0,n.jsxs)(v.l,{selectionVariant:"single",children:[(0,n.jsx)(v.l.Item,{selected:r.id===l.id,onSelect:()=>{i(l),c(l.defaultBranch),u(l.defaultBranch),t(!1)},children:`${l.ownerLogin}/${l.name}`}),(0,n.jsx)(v.l.Item,{selected:r.id===s.id,onSelect:()=>{i(s),c(s.defaultBranch),u(s.defaultBranch),t(!1)},children:`${s.ownerLogin}/${s.name}`})]})})})]})}try{x.displayName||(x.displayName="ForkPicker")}catch{}var N=r(98013),C=r(85788);function k({channel:e="",onUpdate:t}){let[,r]=(0,C.ok)(),n=(0,a.useCallback)(e=>{t(e),r(t=>(t.set("branch_event",encodeURIComponent(e.reason)),t))},[t,r]);return(0,N.x)(e,n),null}try{k.displayName||(k.displayName="LiveBranches")}catch{}function j({branchListCacheKey:e,repository:t,repositoryParent:r,createUrl:d,helpUrl:h,liveReload:p}){let[m,b]=(0,a.useState)(!1),[v,w]=(0,a.useState)(t.defaultBranch),[y,g]=(0,a.useState)(t.defaultBranch),[N,C]=(0,a.useState)(""),[j,T]=(0,a.useState)(t),[S,_]=(0,a.useState)(!1),[E,P]=(0,a.useState)(void 0),[A,B]=(0,a.useState)(void 0),[M,F]=(0,a.useState)(!1),[R,I]=(0,a.useState)(!1),[L,$]=(0,a.useState)(void 0),U=(0,a.useRef)(null),W=(0,a.useRef)(null);function D(){P(void 0),B(void 0),C(""),F(!1)}async function K(){if(!R){I(!0);let e=new FormData;e.append("name",N),e.append("branch",y),r&&e.append("repo",j.id.toString()),e.append("send_response_as_json","true");let t=await (0,c.DI)(d,{method:"post",body:e,headers:{Accept:"application/json"}}),n=await t.json();if(t.ok)D(),b(!1),p&&n.channel?$(n.channel):window.location.reload();else{let e=n.error;e?.includes("Repository rule violations found")?(B(void 0),P(e.replace("Repository rule violations found","").trim().split(`

`).slice(0,3))):e&&(P(void 0),B(e.trim()))}I(!1)}}return(0,a.useEffect)(()=>{m&&requestAnimationFrame(()=>W.current?.focus())},[m]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Q,{ref:U,variant:"primary",className:"ml-3",onClick:()=>{D(),b(!0)},children:"New branch"}),m&&(0,n.jsx)(s.l,{title:"Create a branch",width:"large",onClose:()=>{b(!1),D()},returnFocusRef:U,footerButtons:M?[]:[{content:"Cancel",buttonType:"normal",onClick:()=>{b(!1),D()}},{content:"Create new branch",buttonType:"primary",onClick:K}],children:(0,n.jsxs)(n.Fragment,{children:[(E||A)&&(0,n.jsx)(u.r,{prefix:"Unable to create branch:",errorMessageUsingPrefix:E?"Please address the rule violations and try again.":void 0,errorMessageNotUsingPrefix:A,ruleErrors:E,helpUrl:h}),(0,n.jsx)("form",{onSubmit:e=>{e.preventDefault(),K()},children:(0,n.jsx)(f,{newBranchName:N,setNewBranchName:C,ref:W})}),(0,n.jsx)("div",{className:"mt-3",children:(0,n.jsxs)(i.A,{children:[(0,n.jsx)(i.A.Label,{className:"mb-0",children:"Source"}),r&&(0,n.jsx)(x,{isForkSourceOpen:S,setForkSourceOpen:_,repoSource:j,setRepoSource:T,repository:t,repositoryParent:r,setDefaultBranch:w,setBranchSource:g}),(0,n.jsx)(l.PI,{currentCommitish:y,defaultBranch:v,owner:j.ownerLogin,repo:j.name,canCreate:!1,cacheKey:e,selectedRefType:"branch",onSelectItem:e=>g(e),closeOnSelect:!0,types:["branch"],hideShowAll:!0})]})})]})}),L?(0,n.jsx)(k,{channel:L,onUpdate:()=>$(void 0)}):null]})}try{j.displayName||(j.displayName="CreateBranchButton")}catch{}},71678:(e,t,r)=>{r.d(t,{r:()=>d});var n=r(74848),a=r(38621),o=r(6869),i=r(34614),s=r(53110),l=r(30422);let c={Flash:"FlashError-module__Flash--K1Pqg",SafeHTMLText:"FlashError-module__SafeHTMLText--SdUAj",Link:"FlashError-module__Link--Wl_Ij",ruleViolationsTitle:"FlashError-module__ruleViolationsTitle--jE3vv",ruleViolationRow:"FlashError-module__ruleViolationRow--WhUAP",Octicon:"FlashError-module__Octicon--t8KGC",ruleViolationText:"FlashError-module__ruleViolationText--iO4rA"};var u=r(34164);function d({prefix:e,errorMessageUsingPrefix:t,errorMessageNotUsingPrefix:r,hideRuleErrorsTitle:d,ruleErrors:h,helpUrl:p,flashRef:m}){let f=(h?.length||0)>0;return t||r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.A,{id:"flash",variant:"danger",className:(0,u.$)("d-flex flex-items-center flex-justify-between",c.Flash),tabIndex:-1,ref:m,children:t?(0,n.jsxs)("div",{children:[e," ",(0,n.jsx)(l.BC,{className:c.SafeHTMLText,html:t}),f&&p&&(0,n.jsx)(i.A,{href:`${p}/repositories/configuring-branches-and-merges-in-your-repository/managing-rulesets/about-rulesets`,className:c.Link,children:"Learn more about rulesets."})]}):r&&(0,n.jsx)("div",{children:r})}),f&&(0,n.jsxs)("div",{className:c.Flash,children:[!d&&(0,n.jsx)("div",{className:c.ruleViolationsTitle,children:"Repository rule violations found:"}),h?.map(e=>(0,n.jsxs)("div",{className:c.ruleViolationRow,children:[(0,n.jsx)(s.A,{icon:a.XCircleFillIcon,size:16,className:c.Octicon}),(0,n.jsx)("div",{className:c.ruleViolationText,children:e})]},e))]})]}):null}try{d.displayName||(d.displayName="FlashError")}catch{}},30422:(e,t,r)=>{r.d(t,{BC:()=>c,JU:()=>d,Pk:()=>l});var n=r(74848),a=r(75177),o=r(52464),i=r(99418),s=r(96540);let l=h(a.A),c=h(o.A),u=(0,s.forwardRef)((e,t)=>(0,n.jsx)("div",{ref:t,...e}));u.displayName="Div";let d=h(u);function h(e){let t=(0,s.forwardRef)((t,r)=>{let{sanitizedHTML:a,props:o}=function(e){let{html:t,domPurifyConfig:r,...n}=e,a={...r,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1};return{sanitizedHTML:i.default.sanitize(t,a),props:n}}(t);return(0,n.jsx)(e,{ref:r,...o,dangerouslySetInnerHTML:{__html:a}})});return t.displayName=`UnsafeHTML${e.displayName||e.name}`,t}try{d.displayName||(d.displayName="UnsafeHTMLDiv")}catch{}},97665:(e,t,r)=>{r.d(t,{Ht:()=>s,jE:()=>i,v4:()=>o});var n=r(96540),a=r(74848),o=n.createContext(void 0),i=e=>{let t=n.useContext(o);if(e)return e;if(!t)throw Error("No QueryClient set, use QueryClientProvider to set one");return t},s=({client:e,children:t})=>(n.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),(0,a.jsx)(o.Provider,{value:e,children:t}))}}]);
//# sourceMappingURL=ui_packages_use-client-value_use-client-value_ts-ui_packages_create-branch-button_CreateBranc-fdbbf6-c02a7bc6b52f.js.map